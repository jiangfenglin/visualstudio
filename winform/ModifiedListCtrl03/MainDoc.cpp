/////////////////////////////////////////////////////////////////////////////
// MainDoc.cpp : implementation of the CMainDoc class
/////////////////////////////////////////////////////////////////////////////

#include "StdAfx.h"
#include "Main.h"
#include "MainDoc.h"

#ifdef _DEBUG
	#define new DEBUG_NEW
#undef THIS_FILE
	static char THIS_FILE[] = __FILE__;
#endif

/////////////////////////////////////////////////////////////////////////////
// CMainDoc
/////////////////////////////////////////////////////////////////////////////

IMPLEMENT_DYNCREATE(CMainDoc, CDocument)

BEGIN_MESSAGE_MAP(CMainDoc, CDocument)
	//{{AFX_MSG_MAP(CMainDoc)
	//}}AFX_MSG_MAP
END_MESSAGE_MAP()

/////////////////////////////////////////////////////////////////////////////
// CMainDoc construction
/////////////////////////////////////////////////////////////////////////////
CMainDoc::CMainDoc() {
	//*** Main Application Pointer
	CMainApp *pMainApp = reinterpret_cast<CMainApp *>(AfxGetApp());

	if(!pMainApp) {
		_M("CMainDoc: Empty object of the CMainApp class!");
		return;
	}

	//*** Gets table Id
	ETABLE eTable = pMainApp->m_eTable;

	//*** The Meta Table Structure
	m_MetaTable = pMainApp->m_aMetaTable[eTable];
}  // CMainDoc

/////////////////////////////////////////////////////////////////////////////
// CMainDoc destruction
/////////////////////////////////////////////////////////////////////////////
CMainDoc::~CMainDoc() {
}  // ~CMainDoc

/////////////////////////////////////////////////////////////////////////////
// OnNewDocument
/////////////////////////////////////////////////////////////////////////////
BOOL CMainDoc::OnNewDocument() {
	if(!CDocument::OnNewDocument()) {
		_M("CMainDoc: Failed to call CDocument::OnNewDocument function!");

		return FALSE;
	}

	//*** Changes window name
	SetTitle(m_MetaTable.szTblName);

	return TRUE;
}  // OnNewDocument
/*
/////////////////////////////////////////////////////////////////////////////
// Serialize : CMainDoc serialization
/////////////////////////////////////////////////////////////////////////////
void CMainDoc::Serialize(CArchive &ar) {
	if(ar.IsStoring()) {
		// TODO: add storing code here
	} else {
		// TODO: add loading code here
	}
}  // Serialize
*/
/////////////////////////////////////////////////////////////////////////////
// CMainDoc diagnostics
/////////////////////////////////////////////////////////////////////////////
#ifdef _DEBUG
	/////////////////////////////////////////////////////////////////////////////
	// AssertValid
	/////////////////////////////////////////////////////////////////////////////
	void CMainDoc::AssertValid() const {
		CDocument::AssertValid();
	}  // AssertValid

	/////////////////////////////////////////////////////////////////////////////
	// Dump
	/////////////////////////////////////////////////////////////////////////////
	void CMainDoc::Dump(CDumpContext &dc) const {
		CDocument::Dump(dc);
	}  // Dump
#endif //_DEBUG

/////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////
